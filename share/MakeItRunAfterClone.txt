# Karl Keusgen
# 2020-04-23
#
# Steps to proceed after cloning to make this repository run

git clone https://github.com/DWTSteuerung/multusd.git

#Link clone directory to /multus
# ln -s <PATH TO Clone directory> /multus

sudo mv /var/www/html /var/www/html.old
sudo ln -s /multus/html /var/www/html

# This are the configs
cp /multus/share/configs/multusd.conf /multus/etc/
cp /multus/share/configs/multusd_d/* /multus/etc/multusd_d/

# make configs writable by apache2 - php
sudo chmod a+w /multus/etc/multusd_d/*

# enable multusd as a systemd service
sudo cp /multus/share/multusd.service /etc/systemd/system/
sudo systemctl enable multusd

# make the logs beeing rotated
sudo cp /multus/share/multuslogs /etc/logrotate.d/

# make dir writable by http
mkdir /multus/openvpn
sudo chmod -R a+w /multus/openvpn

mkdir /multus/tmp
chmod -R a+w /multus/tmp

mkdir /multus/log
mkdir /multus/run

chmod a+x /multus/bin/*.py
chmod a+x /multus/bin/*.sh

# run
/multus/share/DoAllProtoFiles.sh

# make logfiles accessable by http
#
# sudo crontab -e
# add line:
# 
# */10    *   *   *   *   /multus/bin/setrights.sh 

cd /multus/html
git clone https://github.com/potsky/PimpMyLog.git
mv PimpMyLog logs

cp /multus/share/configs/config.user.php /multus/html/logs

## we are done
# Setup OpenVPN via http

